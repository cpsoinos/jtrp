<%= render 'layouts/sidebar', navtab: 'dashboard' %>

<div class="main-panel">
  <nav class="navbar navbar-transparent navbar-absolute">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="sidebar-brand" href="#">Dashboard</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="#pablo" class="dropdown-toggle" data-toggle="dropdown">
              <i class="material-icons">dashboard</i>
              <p class="hidden-lg hidden-md">Dashboard</p>
            </a>
          </li>
          <!-- <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="material-icons">notifications</i>
              <span class="notification">5</span>
              <p class="hidden-lg hidden-md">Notifications</p>
            </a>
            <ul class="dropdown-menu">
              <li><a href="#">Mike John responded to your email</a></li>
              <li><a href="#">You have 5 new tasks</a></li>
              <li><a href="#">You're now friend with Andrew</a></li>
              <li><a href="#">Another Notification</a></li>
              <li><a href="#">Another One</a></li>
            </ul>
          </li> -->
          <li>
            <a href="#pablo" class="dropdown-toggle" data-toggle="dropdown">
              <i class="material-icons">person</i>
              <p class="hidden-lg hidden-md">Profile</p>
            </a>
          </li>
        </ul>

        <form class="navbar-form navbar-right" role="search">
          <div class="form-group  is-empty">
            <input type="text" class="form-control" placeholder="Search">
            <span class="material-input"></span>
          </div>
          <button type="submit" class="btn btn-white btn-round btn-just-icon">
            <i class="material-icons">search</i><div class="ripple-container"></div>
          </button>
        </form>
      </div>
    </div>
  </nav>



  <div class="content">
    <div class="container-fluid">
      <div class="row">

        <div class="col-lg-3 col-md-6 col-sm-6">
          <div class="card card-stats">
            <div class="card-header" data-background-color="purple">
              <i class="material-icons">store</i>
            </div>
            <div class="card-content">
              <p class="category">Owned</p>
              <h3 class="title"><%= @metrics[:owned_count] %></h3>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">weekend</i> owned items for sale
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 col-sm-6">
          <div class="card card-stats">
            <div class="card-header" data-background-color="blue">
              <i class="material-icons">supervisor_account</i>
            </div>
            <div class="card-content">
              <p class="category">Consigned</p>
              <h3 class="title"><%= @metrics[:consigned_count] %></h3>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">weekend</i> consigned items for sale
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 col-sm-6">
          <div class="card card-stats">
            <div class="card-header" data-background-color="orange">
              <i class="fa fa-twitter"></i>
            </div>
            <div class="card-content">
              <p class="category">Potential</p>
              <h3 class="title"><%= @metrics[:consigned_count] %></h3>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">weekend</i> potential items in proposals
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-6 col-sm-6">
          <div class="card card-stats">
            <div class="card-header" data-background-color="green">
              <i class='fa fa-credit-card-alt' aria-hidden='true'></i>
            </div>
            <div class="card-content">
              <p class="category">Revenue</p>
              <h3 class="title"><%= humanized_money_with_symbol(@metrics[:thirty_day_revenue]) %></h3>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">date_range</i> Last 30 Days
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="row">
        <div class="col-md-4">
          <div class="card">
            <div class="card-header card-chart" data-background-color="green">
              <div class="ct-chart" id="dailySalesChart"></div>
            </div>
            <div class="card-content">
              <h4 class="title">Daily Sales</h4>
              <p class="category">
                <% if @metrics[:sales_change] > 0 %>
                  <span class="text-success">
                    <i class="fa fa-long-arrow-up"></i> <%= @metrics[:sales_change] %>%
                  </span> increase in sales over last week
                <% else %>
                  <span class="text-danger">
                    <i class="fa fa-long-arrow-down"></i> <%= @metrics[:sales_change] %>%
                  </span> decrease in sales since last week
                <% end %>
              </p>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">access_time</i> updated 4 minutes ago
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card">
            <div class="card-header card-chart" data-background-color="red">
              <div class="ct-chart" id="customerMetricsChart"></div>
            </div>
            <div class="card-content">
              <h4 class="title">Daily Customers</h4>
              <p class="category">
                <% if @metrics[:customers_change] > 0 %>
                  <span class="text-success">
                    <i class="fa fa-long-arrow-up"></i> <%= @metrics[:customers_change] %>%
                  </span> increase in new customers over last week
                <% else %>
                  <span class="text-danger">
                    <i class="fa fa-long-arrow-down"></i> <%= @metrics[:customers_change] %>%
                  </span> decrease in new customers since last week
                <% end %>
              </p>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">access_time</i> campaign sent 2 days ago
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card">
            <div class="card-header card-chart" data-background-color="orange">
              <div class="ct-chart" id="clientMetricsChart"></div>
            </div>
            <div class="card-content">
              <h4 class="title">Monthly Clients</h4>
              <p class="category">
                <% if @metrics[:clients_change] > 0 %>
                  <span class="text-success">
                    <i class="fa fa-long-arrow-up"></i> <%= @metrics[:clients_change] %>%
                  </span> increase in new clients over last month
                <% else %>
                  <span class="text-danger">
                    <i class="fa fa-long-arrow-down"></i> <%= @metrics[:clients_change] %>%
                  </span> decrease in new clients since last month
                <% end %>
              </p>
            </div>
            <div class="card-footer">
              <div class="stats">
                <i class="material-icons">access_time</i> campaign sent 2 days ago
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="row">
        <div class="col-lg-6 col-md-12">
          <div class="card card-nav-tabs">
            <div class="card-header" data-background-color="purple">
              <div class="nav-tabs-navigation">
                <div class="nav-tabs-wrapper">
                  <span class="nav-tabs-title">Tasks:</span>
                  <ul class="nav nav-tabs" data-tabs="tabs">
                    <li class="active">
                      <a href="#profile" data-toggle="tab">
                        <i class="material-icons">weekend</i> Items
                        <div class="ripple-container"></div>
                      </a>
                    </li>
                    <li class="">
                      <a href="#messages" data-toggle="tab">
                        <i class="material-icons">assignment</i> Agreements
                        <div class="ripple-container"></div>
                      </a>
                    </li>
                    <li class="">
                      <a href="#settings" data-toggle="tab">
                        <i class="material-icons">account_balance_wallet</i> Statements
                        <div class="ripple-container"></div>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="card-content">
              <div class="tab-content">

                <div class="tab-pane active" id="profile">
                  <% @items.each do |todo| %>
                    <%= render 'items/to_do_task', cached: true, item: todo, task_field: todo.task[:task_field] %>
                    <div id="to-do-list-item-<%= todo.id %>">
                      <div class="row list-group-item vertical-align">
                        <div class="col-xs-4">
                          <a href="<%= item_path(todo) %>">
                            <%= image_tag(todo.featured_photo.photo_url(client_hints: true, quality: "auto", fetch_format: :auto, width: :auto, dpr: "auto", effect: :improve), class: "img-raised img-responsive", alt: "icon") %>
                          </a>
                        </div>
                        <div class="col-xs-6">
                          <h4 class="list-group-item-heading"><%= todo.task[:name] %></h4>
                          <p class="list-group-item-text"><%= link_to todo.description, item_path(todo) %> <%= todo.task[:description] %></p>
                        </div>
                        <div class="col-xs-2">
                          <button type="button" class="btn btn-fab btn-fab-mini btn-primary" data-toggle="modal" data-target="#<%= todo.id %>-task-modal">
                            <i class='material-icons'>done</i>
                          </button>
                        </div>
                      </div>
                      <div class="list-group-separator"></div>
                    </div>
                  <% end %>
                </div>

                <div class="tab-pane" id="messages">
                  <% @statements.each do |todo| %>
                    <%= render 'statements/to_do_task', statement: todo, task_field: todo.task[:task_field] %>
                    <div id="to-do-list-statement-<%= todo.id %>">
                      <div class="row list-group-item vertical-align">
                        <div class="col-xs-4 text-center">
                          <a href="account_statement_path(todo.account, todo)">
                            <div class="icon icon-<%= todo.unpaid? ? 'success' : 'info' %>">
                              <i class='material-icons' style='font-size: 5em;'>account_balance_wallet</i>
                            </div>
                          </a>
                        </div>
                        <div class="col-xs-6">
                          <h4 class="list-group-item-heading"><%= todo.task[:name] %></h4>
                          <p class="list-group-item-text"><%= link_to "#{todo.account.full_name} - #{todo.date.last_month.strftime('%B, %Y')}", account_statement_path(todo.account, todo) %> <%= todo.task[:description] %></p>
                        </div>
                        <div class="col-xs-2">
                          <button type="button" class="btn btn-fab btn-fab-mini btn-primary" data-toggle="modal" data-target="#statement-<%= todo.id %>-task-modal">
                            <i class='material-icons'>done</i>
                          </button>
                        </div>
                      </div>
                      <div class="list-group-separator"></div>
                    </div>
                  <% end %>
                </div>

                <div class="tab-pane" id="settings">
                  <% @agreements.each do |todo| %>
                    <% next if (!todo.meets_requirements_expired? && todo.letters.by_category('agreement_pending_expiration').present?) %>
                    <%= render 'agreements/to_do_task', collection: @todos, cached: true, agreement: todo, task_field: todo.task[:task_field] %>
                    <div id="to-do-list-agreement-<%= todo.id %>">
                      <div class="row list-group-item vertical-align">
                        <div class="col-xs-4 text-center">
                          <a href="<%= agreement_path(todo) %>">
                            <div class="icon icon-<%= todo.meets_requirements_expired? ? 'danger' : 'warning' %>">
                              <i class='material-icons' style='font-size: 5em;'>access_time</i>
                            </div>
                          </a>
                        </div>
                        <div class="col-xs-6">
                          <h4 class="list-group-item-heading"><%= todo.task[:name] %></h4>
                          <p class="list-group-item-text">
                            <%= link_to (todo.meets_requirements_expired? ? "#{todo.account.primary_contact.full_name} - Agreement No. #{todo.id}" : todo.account.primary_contact.full_name), agreement_path(todo) %> <%= todo.task[:description] %>
                          </p>
                        </div>
                        <div class="col-xs-2">
                          <button type="button" class="btn btn-fab btn-fab-mini btn-primary" data-toggle="modal" data-target="#agreement-<%= todo.id %>-task-modal">
                            <i class='material-icons'>done</i>
                          </button>
                        </div>
                      </div>
                      <div class="list-group-separator"></div>
                    </div>
                  <% end %>
                </div>

              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-6 col-md-12">
          <div class="card">
            <div class="card-header" data-background-color="orange">
              <h4 class="title">Activity Feed</h4>
              <p class="category">New employees on 15th September, 2016</p>
            </div>
            <div class="card-content table-responsive">
              <table class="table table-hover">
                <thead class="text-warning">
                  <th>ID</th>
                  <th>Name</th>
                  <th>Salary</th>
                  <th>Country</th>
                </thead>
                <tbody>
                  <tr>
                    <td>1</td>
                    <td>Dakota Rice</td>
                    <td>$36,738</td>
                    <td>Niger</td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>Minerva Hooper</td>
                    <td>$23,789</td>
                    <td>Curaçao</td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>Sage Rodriguez</td>
                    <td>$56,142</td>
                    <td>Netherlands</td>
                  </tr>
                  <tr>
                    <td>4</td>
                    <td>Philip Chaney</td>
                    <td>$38,735</td>
                    <td>Korea, South</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
